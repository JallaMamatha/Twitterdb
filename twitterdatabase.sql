
--CREATE DATABASE--


CREATE DATABASE TWITTERDB;

--USE PARTICULAR DATABASE--
USE TWITTERDB;

--CREATE TWEETS TABLE--
CREATE TABLE TWEETS
 
(
    TWEET_ID INT PRIMARY KEY,
    USER_ID INT NOT NULL,
    TYPE VARCHAR(50),
    TWEET_DATE DATE NOT NULL,
    MESSAGE   VARCHAR(100) NOT NULL,
    TOTAL_LIKES INT

);


	INSERT INTO TWEETS(TWEET_ID,USER_ID,TYPE,TWEET_DATE,MESSAGE,TOTAL_LIKES) VALUES(1,4,'IMAGES','2021-03-04','MESSAGES FROM A"MAMATHA"',3429);
	INSERT INTO TWEETS(TWEET_ID,USER_ID,TYPE,TWEET_DATE,MESSAGE,TOTAL_LIKES) VALUES(2,1,'LINKS','2020-05-12','MESSAGES FROM "KULASEKHAR"',5425);
	INSERT INTO TWEETS(TWEET_ID,USER_ID,TYPE,TWEET_DATE,MESSAGE,TOTAL_LIKES) VALUES(3,2,'QUOTES','2021-07-09','MESSAGES FROM "AVINASH"',7472);
	INSERT INTO TWEETS(TWEET_ID,USER_ID,TYPE,TWEET_DATE,MESSAGE,TOTAL_LIKES) VALUES(4,5,'RETWEETS','2021-02-12','MESSAGES FROM "SAI AKASH"',6742);
	INSERT INTO TWEETS(TWEET_ID,USER_ID,TYPE,TWEET_DATE,MESSAGE,TOTAL_LIKES) VALUES(5,3,'COMMENTS','2021-10-10','MESSAGES FROM "INDRAJA"',3472);

	SELECT * FROM TWEETS;

	--CREATE USERS TABLE--

	
  CREATE TABLE USERS
   (
   ID INT PRIMARY KEY,
   USERNAME VARCHAR(40),
   EMAIL VARCHAR(50),
   CREATED_AT DATE,
   UPDATED_AT DATE
   );

   
   INSERT INTO USERS VALUES(1,'INDRAJA REDDY','indrajaramireddy@gmail.com','2014-04-21','2019-02-28');
   INSERT INTO USERS VALUES(2,'KULASEKAR REDDY','kulasekharreddy@gmail.com','2009-04-07','2014-03-05');
   INSERT INTO USERS VALUES(3,'SAI AKASH','saiakash12@gmail.com','2017-03-15','2019-09-18');
   INSERT INTO USERS VALUES(4,'JALLA MAMATHA','mamathajalla@gmail.com','2014-05-26','2019-12-20');
   INSERT INTO USERS VALUES(5,'AVINASH','avinash123@gmail.com','2017-06-14','2018-05-12');

   SELECT * FROM USERS;

 -- CREATE TWEET_LIKES TABLE--
 
CREATE TABLE TWEET_LIKES
(
ID INT PRIMARY KEY,
POST_ID INT,
USER_ID INT,
CREATED_AT DATE,
UPDATED_AT DATE,
);



INSERT INTO TWEET_LIKES VALUES(1,001,1000,'2014-05-10','2015-06-11');
INSERT INTO TWEET_LIKES VALUES(2,002,1001,'2015-05-11','2016-06-12');
INSERT INTO TWEET_LIKES VALUES(3,003,1002,'2016-05-12','2017-06-13');
INSERT INTO TWEET_LIKES VALUES(4,004,1003,'2017-05-13','2018-06-14');
INSERT INTO TWEET_LIKES VALUES(5,005,1004,'2018-05-14','2019-06-15');

SELECT * FROM TWEET_LIKES;


	ALTER TABLE TWEET_LIKES
	ADD NO_OF_LIKES INT;

	TRUNCATE TABLE TWEET_LIKES;

	
INSERT INTO TWEET_LIKES VALUES(1,001,1000,'2014-05-10','2015-06-11',456);
INSERT INTO TWEET_LIKES VALUES(2,002,1001,'2015-05-11','2016-06-12',492);
INSERT INTO TWEET_LIKES VALUES(3,003,1002,'2016-05-12','2017-06-13',590);
INSERT INTO TWEET_LIKES VALUES(4,004,1003,'2017-05-13','2018-06-14',577);
INSERT INTO TWEET_LIKES VALUES(5,005,1004,'2018-05-14','2019-06-15',376);


-- CREATE USERFEEDS TABLE--

CREATE TABLE USERFEEDS
(
ID INT PRIMARY KEY,
POST_ID INT,
CREATED_AT DATE,
UPDATED_AT DATE,
);

INSERT INTO USERFEEDS VALUES(1,100,'2016-03-15','2018-05-29');
INSERT INTO USERFEEDS VALUES(2,101,'2017-07-25','2020-04-18');
INSERT INTO USERFEEDS VALUES(3,102,'2015-08-13','2019-07-16');
INSERT INTO USERFEEDS VALUES(4,103,'2008-02-16','2021-01-15');
INSERT INTO USERFEEDS VALUES(5,104,'2005-06-30','2020-04-25');

SELECT * FROM USERFEEDS;

--CREATE USER_FOLLOWERS TABLE--

   CREATE TABLE USER_FOLLOWERS
(
  ID INT PRIMARY KEY,
  USERID INT,
  FOLLOWERID INT,
  CREATED_AT DATE,
  UPDATED_AT DATE
);

INSERT INTO USER_FOLLOWERS VALUES(1,11,12,'2014-04-21','2019-02-28');
INSERT INTO USER_FOLLOWERS VALUES(2,12,13,'2009-04-07','2014-03-05');
INSERT INTO USER_FOLLOWERS VALUES(3,13,14,'2017-03-15','2019-09-18');
INSERT INTO USER_FOLLOWERS VALUES(4,14,15,'2014-05-26','2019-12-20');
INSERT INTO USER_FOLLOWERS VALUES(5,15,16,'2017-06-14','2018-05-12');

SELECT * FROM USER_FOLLOWERS;

--CREATE COMMENTS TABLE--

CREATE TABLE COMMENTS
(
ID INT PRIMARY KEY,
POST_ID INT,
USER_ID1 VARCHAR(40),
COMMENT VARCHAR(100),
UPDATED_AT  DATE,
CREATED_AT DATE
);

INSERT INTO COMMENTS VALUES(1,94,11,'WHAT ALONE MUST THINKING','2016-06-22','2016-06-29');
INSERT INTO COMMENTS VALUES(2,87,22,'WHY THINGS HAPPENS LIKE THAT','2034-04-12','2034-04-29');
INSERT INTO COMMENTS VALUES(3,43,33,'ANYTHING HAPPEND IN THE WORLD','2015-05-22','2015-05-29');
INSERT INTO COMMENTS VALUES(4,33,34,'JAI BALLAYA','2014-04-12','2014-04-19');
INSERT INTO COMMENTS VALUES(5,44,35,'HAPPY BDY  BALLAYA','2013-07-22','2013-07-29');

SELECT * FROM COMMENTS;

-- ADDING FOREIGN KEY CONSTRAINTS--

ALTER TABLE TWEET_LIKES ADD  FOREIGN KEY(ID) REFERENCES USER_FOLLOWERS(ID);

ALTER TABLE TWEETS ADD FOREIGN KEY(TWEET_ID) REFERENCES USERS(ID);

ALTER TABLE USERS ADD FOREIGN KEY(ID) REFERENCES USERFEEDS(ID);

ALTER TABLE TWEET_LIKES ADD FOREIGN KEY(ID) REFERENCES USERS(ID);

ALTER TABLE TWEET_LIKES ADD FOREIGN KEY(ID) REFERENCES TWEETS(TWEET_ID);


ALTER TABLE COMMENTS ADD FOREIGN KEY(ID) REFERENCES TWEETS(TWEET_ID);

ALTER TABLE USERFEEDS ADD FOREIGN KEY(ID) REFERENCES USER_FOLLOWERS(ID);

ALTER TABLE USER_FOLLOWERS ADD FOREIGN KEY(ID) REFERENCES TWEETS(TWEET_ID);


  --MAMATHA--

	/*1.WRITE A QUERY TO DISPLAY TWEETS POSTED BY USER AND TYPE NAME END WITH S*/

	SELECT * FROM TWEETS T WHERE USER_ID=1 AND TYPE LIKE'%S' ORDER BY TWEET_DATE DESC;

	/*2.WRITE A QUERY TO DISPLAY TWEETS OF THE FOLLOWERS NEED TO BE ACCESSED USING A JOIN */

     SELECT T.USER_ID,T.TOTAL_LIKES,F.FOLLOWERID FROM TWEETS T JOIN USER_FOLLOWERS F 
	 ON (USER_ID = ID) WHERE FOLLOWERID =15 ORDER BY TWEET_ID DESC;

	/*3.WRITE  A QUERY TO DISPLAY TWEETS_ID,TYPE ,EMAIL FROM USERS AND TWEETS TABLE USING WHERE CLUASE*/
	
		 SELECT T.TWEET_ID,T.TYPE,U.EMAIL 
		 FROM TWEETS T,USERS U
		 WHERE T.USER_ID = U.ID;

	/*4.WRITE A QUERY DISPLAY TO USERID AND NO.OF USERID FROM TWEETS TABLE USING GROUP BY AND HAVING    */
	    
		 SELECT USER_ID,COUNT(USER_ID) FROM TWEETS
		 GROUP BY USER_ID
		 HAVING COUNT(USER_ID)>=1;

    /*5.WRITE A QUERY DISPLAY TWEET_ID,USERNAME FROM TWO TABLES USING INNER JOIN*/
	
         SELECT TWEETS.TWEET_ID,USERS.USERNAME
		 FROM USERS INNER JOIN TWEETS ON USERS.ID = TWEETS.USER_ID;

	--INDRAJA--

    /*1.WRITE A QUERY TO SELECT USERID IS GREATER THAN EQUAL TO 1 AND TWEET_ID IS LESS THAN EQUALTO 2*/

	     SELECT U.ID FROM USERS U WHERE ID>=1
		 UNION ALL
		 SELECT T.TWEET_ID FROM TWEETS T WHERE TWEET_ID<=2;

	/*2.WRITE A QUERY TO DISPLAY USERNAME AND EMAIL BY USING SINGLE ROW FUNCTIONS */

	  SELECT LOWER(USERNAME),UPPER(EMAIL) FROM USERS;

	  /*3.WRITE A QUERY TO DISPLAY THE POST_ID IF THEY ARE CREATED INT THE YEAR 2016 */

	  SELECT POST_ID,CREATED_AT FROM USERFEEDS WHERE CREATED_AT LIKE'%16';

	  /*4.WRITE A QUERY TO SELECT TWEET_ID,T.TYPE,U.ID,U.USERNAME USING RIGHT JOIN */

	  SELECT T.TWEET_ID,T.TYPE,U.ID,U.USERNAME FROM TWEETS T RIGHT JOIN USERS U ON T.TWEET_ID=U.ID;

	  /*5.WRITE A QUERY TO DISPLAY POSTID AND USER NAME FROM TWO TABLES USING INNER JOIN */

	  SELECT UF.ID,UF.POST_ID,U.ID,U.USERNAME FROM USERFEEDS UF INNER JOIN USERS U ON UF.ID=U.ID;

	  --AVINASH--

	   
    SELECT DISTINCT CREATED_AT,ID, COMMENT FROM COMMENTS; 

WAQ TO SELECT USERID,USERNAME AND COMMENT FROM THE USERS BY USING WHERE CLAUSE 

SELECT U.ID AS USERID,U.USERNAME,C.COMMENT FROM USERS U,COMMENTS C WHERE U.ID=C.ID; 

WRITE A QUERY TO DISPLAY NO LIKES OF FOR COMMNETS BY USING RIGHT JOIN 

SELECT TWEET_LIKES.ID,TWEET_LIKES.POST_ID,TWEET_LIKES.CREATED_AT,TWEET_LIKES.UPDATED_AT,TWEET_LIKES.NO_OF_LIKES,COMMENTS.COMMENT FROM TWEET_LIKES RIGHT JOIN COMMENTS
ON TWEET_LIKES.ID=COMMENTS.ID; 


		 --SAI AKASH--


	/*1.WRITE A QUERY TO SELECT TWEET ID,USERNAME,EMAIL,BY USING FULL JOIN*/

	 SELECT T.TWEET_ID,U.USERNAME,U.EMAIL FROM TWEETS T FULL JOIN USERS U ON T.USER_ID=U.ID;

	 /*2.WRITE A QUERY TO SELECT TWEET ID AND TYPE EXCEPT TWEET_ID IS 1*/

	 SELECT TWEET_ID,TYPE FROM TWEETS EXCEPT SELECT TWEET_ID,TYPE FROM TWEETS WHERE TWEET_ID=1;

	 /*3.WRITE A QUERY TO SELECT USER FEEDID,CREATE DATE WHERE NO OF LIKES GREATER THAN 300 */

	 SELECT UF.ID,UF.CREATED_AT FROM USERFEEDS UF WHERE UF.ID IN(SELECT TL.ID FROM TWEET_LIKES TL WHERE NO_OF_LIKES>=300);

	 /*4.WRITE A QUERY TO SELECT POSTID,USERNAME,MESSAGE USING WHERE CLAUSE*/

	 SELECT TL.POST_ID,U.USERNAME,T.MESSAGE FROM TWEET_LIKES TL,USERS U,TWEETS T WHERE TL.ID=U.ID AND U.ID=T.TWEET_ID;

	/*5.WRITE A QUERY TO SELECT FOLLOWERID AS TWITTERID AND USERNAME AS TWEET_NAME USING ALIAS*/

	 SELECT FOLLOWERID AS TWITTER_ID,USERNAME AS TWEET_NAME FROM USER_FOLLOWERS UF,USERS U WHERE UF.ID>
	 (SELECT U.ID FROM TWEET_LIKES WHERE UPDATED_AT='2016-06-12');

	 --KULASEKHAR--

	 /*WAQ TO SELECT THE DETAIL OF THE USERNAME WHOSE NAME*/

	 SELECT * FROM USERS WHERE USERNAME LIKE '%E__%';

	 /*WAQ TO SELECT TWEETS OF THE USERS WHOSE TOTAL LIKES BETWEEN 3000 AND 4000*/

	 SELECT * FROM TWEETS WHERE TOTAL_LIKES BETWEEN 3000 AND 4000;

	 /*WAQ TO DISPLAY ID,MESSAGE FROM USER FOLLOWERS USING INNER JOIN AND TOTAL LIKES IN 3429,3472 */

	 SELECT DISTINCT UF.ID,T.MESSAGE FROM USER_FOLLOWERS UF INNER JOIN TWEETS T 
	 ON UF.ID=T.TWEET_ID AND T.TOTAL_LIKES IN(3429,3472);

	 /*WAQ TO DISPLAY TOP 3 NO_OF_LIKES FROM TWEET_LIKES*/

	 SELECT TOP 3 * FROM TWEET_LIKES ORDER BY NO_OF_LIKES;

	 /*WAQ TO SELECT ID,FOLLOWERID FROM USERFOLLOWERS USING SUBQUERY AND TOTAL LIKES IS GREATER THAN 3000 */
	  
	 SELECT UF.ID,UF.FOLLOWERID FROM USER_FOLLOWERS UF WHERE UF.ID IN(SELECT T.TWEET_ID FROM TWEETS T WHERE TOTAL_LIKES>=3000);
